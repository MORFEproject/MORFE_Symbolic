(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     80921,       2147]
NotebookOptionsPosition[     76942,       2092]
NotebookOutlinePosition[     77347,       2108]
CellTagsIndexPosition[     77304,       2105]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "\"\<Global`*\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"B", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"A", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "1", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"\[Omega]", "^", "2"}]}], ",", 
       RowBox[{
        RowBox[{"-", "2"}], "*", "\[Xi]", "*", "\[Omega]"}], ",", "0"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"var", "=", 
    RowBox[{"{", 
     RowBox[{"z1", ",", "z2"}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", "\"\<Order 1\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"W1", "=", 
   RowBox[{"W11", "+", 
    RowBox[{"W12", "*", "z1"}], "+", 
    RowBox[{"W13", "*", "z2"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"W2", "=", 
   RowBox[{"W21", "+", 
    RowBox[{"W22", "*", "z1"}], "+", 
    RowBox[{"W23", "*", "z2"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"W3", "=", 
   RowBox[{"W31", "+", 
    RowBox[{"W32", "*", "z1"}], "+", 
    RowBox[{"W33", "*", "z2"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"W", "=", 
   RowBox[{"{", 
    RowBox[{"W1", ",", "W2", ",", "W3"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"f1", "=", 
   RowBox[{"f11", "+", 
    RowBox[{"f12", "*", "z1"}], "+", 
    RowBox[{"f13", "*", "z2"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"f2", "=", 
   RowBox[{"f21", "+", 
    RowBox[{"f22", "*", "z1"}], "+", 
    RowBox[{"f23", "*", "z2"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"f", "=", 
   RowBox[{"{", 
    RowBox[{"f1", ",", "f2"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gradW", "=", 
   RowBox[{"Grad", "[", 
    RowBox[{"W", ",", 
     RowBox[{"{", 
      RowBox[{"z1", ",", "z2"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Q", "=", 
    RowBox[{"{", 
     RowBox[{"0", ",", 
      RowBox[{
       RowBox[{"-", "h"}], "*", "W1", "*", "W3"}], ",", 
      RowBox[{"-", 
       RowBox[{"W1", "^", "2"}]}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<W(z) = \>\"", ",", 
   RowBox[{"MatrixForm", "[", "W", "]"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<f(z) = \>\"", ",", 
   RowBox[{"MatrixForm", "[", "f", "]"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<\[Del]W(z) = \>\"", ",", 
   RowBox[{"MatrixForm", "[", "gradW", "]"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<Q(W(z)) = \>\"", ",", 
    RowBox[{"MatrixForm", "[", "Q", "]"}]}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"W11", "=", "0"}], ";", 
  RowBox[{"W21", "=", "0"}], ";", 
  RowBox[{"W31", "=", "0"}], ";", 
  RowBox[{"W32", "=", "0"}], ";", 
  RowBox[{"W33", "=", "0"}], ";", 
  RowBox[{"f11", "=", "0"}], ";", 
  RowBox[{"f21", "=", "0"}], ";", 
  RowBox[{"f13", "=", "0"}], ";", 
  RowBox[{"f22", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"W12", "=", 
    RowBox[{
     RowBox[{"-", "\[ImaginaryI]"}], "*", 
     RowBox[{"(", 
      RowBox[{"\[Xi]", "+", 
       RowBox[{"\[ImaginaryI]", "*", "\[Delta]"}]}], ")"}]}]}], ";", 
   RowBox[{"W13", "=", 
    RowBox[{
     RowBox[{"-", "\[ImaginaryI]"}], "*", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "\[Xi]"}], "+", 
       RowBox[{"\[ImaginaryI]", "*", "\[Delta]"}]}], ")"}]}]}], ";", 
   RowBox[{"W22", "=", 
    RowBox[{"\[ImaginaryI]", "*", "\[Omega]"}]}], ";", 
   RowBox[{"W23", "=", 
    RowBox[{
     RowBox[{"-", "\[ImaginaryI]"}], "*", "\[Omega]"}]}], ";", 
   RowBox[{"f12", "=", 
    RowBox[{"\[Omega]", "*", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "\[Xi]"}], "+", 
       RowBox[{"\[ImaginaryI]", "*", "\[Delta]"}]}], ")"}]}]}], ";", 
   RowBox[{"f23", "=", 
    RowBox[{"\[Omega]", "*", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "\[Xi]"}], "-", 
       RowBox[{"\[ImaginaryI]", "*", "\[Delta]"}]}], ")"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"left", "=", 
   RowBox[{"B", ".", "gradW", ".", "f"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"right", "=", 
   RowBox[{
    RowBox[{"A", ".", "W"}], "+", "Q"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i", "=", "1"}], ",", 
    RowBox[{"i", "<=", "3"}], ",", 
    RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"left", "[", 
       RowBox[{"[", "i", "]"}], "]"}], "=", 
      RowBox[{"FromCoefficientRules", "[", 
       RowBox[{
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"CoefficientRules", "[", 
           RowBox[{
            RowBox[{"left", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", "var"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Total", "@", 
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], "==", "1"}], "&"}]}], "]"}], 
        ",", "var"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"right", "[", 
       RowBox[{"[", "i", "]"}], "]"}], "=", 
      RowBox[{"FromCoefficientRules", "[", 
       RowBox[{
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"CoefficientRules", "[", 
           RowBox[{
            RowBox[{"right", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", "var"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Total", "@", 
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], "==", "1"}], "&"}]}], "]"}], 
        ",", "var"}], "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", "\"\<B.gradW.f = A.W+Q\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{
   RowBox[{"MatrixForm", "[", "left", "]"}], ",", "\"\< = \>\"", ",", 
   RowBox[{"MatrixForm", "[", "right", "]"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Delta]", "=", 
   RowBox[{"Sqrt", "[", 
    RowBox[{"1", "-", 
     RowBox[{"\[Xi]", "^", "2"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"FullSimplify", "[", 
     RowBox[{"left", "==", "right"}], "]"}], ",", 
    RowBox[{"Print", "[", "\"\<OK\>\"", "]"}], ",", 
    RowBox[{"Print", "[", "\"\<Not OK\>\"", "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Clear", "[", "\[Delta]", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", "\"\<Nonlinear mappings\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<u = \>\"", ",", "W1"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<v = \>\"", ",", "W2"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<r = \>\"", ",", "W3"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", "\"\<Reduced dynamics\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<dz1dt = \>\"", ",", "f1"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<dz2dt = \>\"", ",", "f2"}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", "\"\<Order 2\>\"", "]"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"WW12", "=", "W12"}], ";", 
    RowBox[{"WW13", "=", "W13"}], ";", 
    RowBox[{"WW22", "=", "W22"}], ";", 
    RowBox[{"WW23", "=", "W23"}], ";", 
    RowBox[{"ff12", "=", "f12"}], ";", 
    RowBox[{"ff23", "=", "f23"}], ";", "\[IndentingNewLine]", 
    RowBox[{"Clear", "[", 
     RowBox[{
     "W12", ",", "W13", ",", "W22", ",", "W23", ",", "f12", ",", "f23"}], 
     "]"}], ";"}], "*)"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"W1", "=", 
   RowBox[{"W11", "+", 
    RowBox[{"W12", "*", "z1"}], "+", 
    RowBox[{"W13", "*", "z2"}], "+", 
    RowBox[{"W14", "*", 
     RowBox[{"z1", "^", "2"}]}], "+", 
    RowBox[{"W15", "*", "z1", "*", "z2"}], "+", 
    RowBox[{"W16", "*", 
     RowBox[{"z2", "^", "2"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"W2", "=", 
   RowBox[{"W21", "+", 
    RowBox[{"W22", "*", "z1"}], "+", 
    RowBox[{"W23", "*", "z2"}], "+", 
    RowBox[{"W24", "*", 
     RowBox[{"z1", "^", "2"}]}], "+", 
    RowBox[{"W25", "*", "z1", "*", "z2"}], "+", 
    RowBox[{"W26", "*", 
     RowBox[{"z2", "^", "2"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"W3", "=", 
   RowBox[{"W31", "+", 
    RowBox[{"W32", "*", "z1"}], "+", 
    RowBox[{"W33", "*", "z2"}], "+", 
    RowBox[{"W34", "*", 
     RowBox[{"z1", "^", "2"}]}], "+", 
    RowBox[{"W35", "*", "z1", "*", "z2"}], "+", 
    RowBox[{"W36", "*", 
     RowBox[{"z2", "^", "2"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"W", "=", 
   RowBox[{"{", 
    RowBox[{"W1", ",", "W2", ",", "W3"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"f1", "=", 
   RowBox[{"f11", "+", 
    RowBox[{"f12", "*", "z1"}], "+", 
    RowBox[{"f13", "*", "z2"}], "+", 
    RowBox[{"f14", "*", 
     RowBox[{"z1", "^", "2"}]}], "+", 
    RowBox[{"f15", "*", "z1", "*", "z2"}], "+", 
    RowBox[{"f16", "*", 
     RowBox[{"z2", "^", "2"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"f2", "=", 
   RowBox[{"f21", "+", 
    RowBox[{"f22", "*", "z1"}], "+", 
    RowBox[{"f23", "*", "z2"}], "+", 
    RowBox[{"f24", "*", 
     RowBox[{"z1", "^", "2"}]}], "+", 
    RowBox[{"f25", "*", "z1", "*", "z2"}], "+", 
    RowBox[{"f26", "*", 
     RowBox[{"z2", "^", "2"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"f", "=", 
   RowBox[{"{", 
    RowBox[{"f1", ",", "f2"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gradW", "=", 
   RowBox[{"Grad", "[", 
    RowBox[{"W", ",", 
     RowBox[{"{", 
      RowBox[{"z1", ",", "z2"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Q", "=", 
    RowBox[{"{", 
     RowBox[{"0", ",", 
      RowBox[{
       RowBox[{"-", "h"}], "*", "W1", "*", "W3"}], ",", 
      RowBox[{"-", 
       RowBox[{"W1", "^", "2"}]}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<W(z) = \>\"", ",", 
   RowBox[{"MatrixForm", "[", "W", "]"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<f(z) = \>\"", ",", 
   RowBox[{"MatrixForm", "[", "f", "]"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<\[Del]W(z) = \>\"", ",", 
   RowBox[{"MatrixForm", "[", "gradW", "]"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<Q(W(z)) = \>\"", ",", 
    RowBox[{"MatrixForm", "[", "Q", "]"}]}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"f14", "=", "0"}], ";", 
  RowBox[{"f15", "=", "0"}], ";", 
  RowBox[{"f16", "=", "0"}], ";", 
  RowBox[{"f24", "=", "0"}], ";", 
  RowBox[{"f25", "=", "0"}], ";", 
  RowBox[{"f26", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"left", "=", 
   RowBox[{"B", ".", "gradW", ".", "f"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"right", "=", 
   RowBox[{
    RowBox[{"A", ".", "W"}], "+", "Q"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i", "=", "1"}], ",", 
    RowBox[{"i", "<=", "3"}], ",", 
    RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"left", "[", 
       RowBox[{"[", "i", "]"}], "]"}], "=", 
      RowBox[{"FromCoefficientRules", "[", 
       RowBox[{
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"CoefficientRules", "[", 
           RowBox[{
            RowBox[{"left", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", "var"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Total", "@", 
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], "==", "2"}], "&"}]}], "]"}], 
        ",", "var"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"right", "[", 
       RowBox[{"[", "i", "]"}], "]"}], "=", 
      RowBox[{"FromCoefficientRules", "[", 
       RowBox[{
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"CoefficientRules", "[", 
           RowBox[{
            RowBox[{"right", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", "var"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Total", "@", 
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], "==", "2"}], "&"}]}], "]"}], 
        ",", "var"}], "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", "\"\<B.gradW.f = A.W+Q\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{
    RowBox[{"MatrixForm", "[", "left", "]"}], ",", "\"\< = \>\"", ",", 
    RowBox[{"MatrixForm", "[", "right", "]"}]}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"W34", "=", 
   RowBox[{"W12", "^", "2"}]}], ";", 
  RowBox[{"W35", "=", 
   RowBox[{"2", "*", "W12", "*", "W13"}]}], ";", 
  RowBox[{"W36", "=", 
   RowBox[{"W13", "^", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{
  "\"\<W34 = \>\"", ",", "W34", ",", "\"\<, W35 = \>\"", ",", "W35", ",", 
   "\"\<, W36 = \>\"", ",", "W36"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"W14", "=", "0"}], ";", 
  RowBox[{"W24", "=", "0"}], ";", 
  RowBox[{"W15", "=", "0"}], ";", 
  RowBox[{"W25", "=", "0"}], ";", 
  RowBox[{"W16", "=", "0"}], ";", 
  RowBox[{"W26", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "Print", "[", "\"\<W14 = W15 = W16 = W24 = W25 = W26 = 0\>\"", "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"left", "=", 
   RowBox[{"B", ".", "gradW", ".", "f"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"right", "=", 
   RowBox[{
    RowBox[{"A", ".", "W"}], "+", "Q"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i", "=", "1"}], ",", 
    RowBox[{"i", "<=", "3"}], ",", 
    RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"left", "[", 
       RowBox[{"[", "i", "]"}], "]"}], "=", 
      RowBox[{"FromCoefficientRules", "[", 
       RowBox[{
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"CoefficientRules", "[", 
           RowBox[{
            RowBox[{"left", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", "var"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Total", "@", 
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], "==", "2"}], "&"}]}], "]"}], 
        ",", "var"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"right", "[", 
       RowBox[{"[", "i", "]"}], "]"}], "=", 
      RowBox[{"FromCoefficientRules", "[", 
       RowBox[{
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"CoefficientRules", "[", 
           RowBox[{
            RowBox[{"right", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", "var"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Total", "@", 
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], "==", "2"}], "&"}]}], "]"}], 
        ",", "var"}], "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", "\"\<Checking the solution\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", "\"\<B.gradW.f = A.W+Q\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{
   RowBox[{"MatrixForm", "[", "left", "]"}], ",", "\"\< = \>\"", ",", 
   RowBox[{"MatrixForm", "[", "right", "]"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Delta]", "=", 
   RowBox[{"Sqrt", "[", 
    RowBox[{"1", "-", 
     RowBox[{"\[Xi]", "^", "2"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"FullSimplify", "[", 
      RowBox[{"left", "==", "right"}], "]"}], ",", 
     RowBox[{"Print", "[", "\"\<OK\>\"", "]"}], ",", 
     RowBox[{"Print", "[", "\"\<Not OK\>\"", "]"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", "\"\<Solving for order 3 coefficients\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Delta]", "=", 
   RowBox[{"Sqrt", "[", 
    RowBox[{"1", "-", 
     RowBox[{"\[Xi]", "^", "2"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", "\"\<z_1^3 monomial\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]1", " ", "=", " ", 
   RowBox[{"\[Omega]", "*", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"\[ImaginaryI]", "*", "\[Delta]"}], "-", "\[Xi]"}], ")"}]}]}], 
  ";", " ", 
  RowBox[{"\[Lambda]2", "=", 
   RowBox[{"\[Omega]", "*", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "\[ImaginaryI]"}], "*", "\[Delta]"}], "-", "\[Xi]"}], 
     ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mat", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"3", "*", "\[Lambda]1"}], ",", 
       RowBox[{"-", "1"}], ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[Omega]", "^", "2"}], ",", 
       RowBox[{
        RowBox[{"3", "*", "\[Lambda]1"}], "+", 
        RowBox[{"2", "*", "\[Xi]", "*", "\[Omega]"}]}], ",", "0", ",", "0", 
       ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", 
       RowBox[{"-", "1"}], ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "1", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vec", "=", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{
      RowBox[{"-", "h"}], "*", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"\[Delta]", "-", 
         RowBox[{"\[ImaginaryI]", "*", "\[Xi]"}]}], ")"}], "^", "3"}]}], ",", 
     "0", ",", "0", ",", "0"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sol", "=", 
   RowBox[{"Together", "[", 
    RowBox[{"Expand", "[", 
     RowBox[{"FullSimplify", "[", 
      RowBox[{"LinearSolve", "[", 
       RowBox[{"mat", ",", "vec"}], "]"}], "]"}], "]"}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", "\"\<z_1^2*z_2 monomial\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mat", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"2", "*", "\[Lambda]1"}], "+", "\[Lambda]2"}], ",", 
       RowBox[{"-", "1"}], ",", "0", ",", 
       RowBox[{"\[Delta]", "-", 
        RowBox[{"\[ImaginaryI]", "*", "\[Xi]"}]}], ",", 
       RowBox[{"\[Delta]", "+", 
        RowBox[{"\[ImaginaryI]", "*", "\[Xi]"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[Omega]", "^", "2"}], ",", 
       RowBox[{
        RowBox[{"2", "*", "\[Lambda]1"}], "+", "\[Lambda]2", "+", 
        RowBox[{"2", "*", "\[Xi]", "*", "\[Omega]"}]}], ",", "0", ",", 
       StyleBox[
        RowBox[{"\[ImaginaryI]", "*", "\[Omega]"}],
        FontWeight->"Bold"], ",", 
       RowBox[{
        RowBox[{"-", 
         StyleBox["\[ImaginaryI]",
          FontWeight->"Bold"]}], 
        StyleBox["*",
         FontWeight->"Bold"], 
        StyleBox["\[Omega]",
         FontWeight->"Bold"]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", 
       RowBox[{"-", "1"}], ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[Omega]", "*", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[ImaginaryI]", "*", "\[Delta]"}], "+", "\[Xi]"}], ")"}]}],
        ",", "1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[Omega]", "*", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "\[ImaginaryI]"}], "*", "\[Delta]"}], "+", "\[Xi]"}], 
         ")"}]}], ",", "1", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vec", "=", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{
      RowBox[{"-", "3"}], "h", "*", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"\[Delta]", "^", "3"}], "+", 
        RowBox[{
         RowBox[{"\[Xi]", "^", "2"}], "*", "\[Delta]"}], "-", 
        RowBox[{"\[ImaginaryI]", "*", "\[Xi]", "*", 
         RowBox[{"\[Delta]", "^", "2"}]}], "-", 
        RowBox[{"\[ImaginaryI]", "*", 
         RowBox[{"\[Xi]", "^", "3"}]}]}], ")"}]}], ",", "0", ",", "0", ",", 
     "0"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sol", "=", 
   RowBox[{"Together", "[", 
    RowBox[{"Expand", "[", 
     RowBox[{"FullSimplify", "[", 
      RowBox[{"LinearSolve", "[", 
       RowBox[{"mat", ",", "vec"}], "]"}], "]"}], "]"}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", "\"\<z_1*z_2^2 monomial\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mat", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[Lambda]1", "+", 
        RowBox[{"2", "*", "\[Lambda]2"}]}], ",", 
       RowBox[{"-", "1"}], ",", "0", ",", 
       RowBox[{"\[Delta]", "-", 
        RowBox[{"\[ImaginaryI]", "*", "\[Xi]"}]}], ",", 
       RowBox[{"\[Delta]", "+", 
        RowBox[{"\[ImaginaryI]", "*", "\[Xi]"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[Omega]", "^", "2"}], ",", 
       RowBox[{"\[Lambda]1", "+", 
        RowBox[{"2", "*", "\[Lambda]2"}], "+", 
        RowBox[{"2", "*", "\[Xi]", "*", "\[Omega]"}]}], ",", "0", ",", 
       StyleBox[
        RowBox[{"\[ImaginaryI]", "*", "\[Omega]"}],
        FontWeight->"Bold"], ",", 
       RowBox[{
        RowBox[{"-", 
         StyleBox["\[ImaginaryI]",
          FontWeight->"Bold"]}], 
        StyleBox["*",
         FontWeight->"Bold"], 
        StyleBox["\[Omega]",
         FontWeight->"Bold"]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", 
       RowBox[{"-", "1"}], ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[Omega]", "*", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[ImaginaryI]", "*", "\[Delta]"}], "+", "\[Xi]"}], ")"}]}],
        ",", "1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[Omega]", "*", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "\[ImaginaryI]"}], "*", "\[Delta]"}], "+", "\[Xi]"}], 
         ")"}]}], ",", "1", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vec", "=", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{
      RowBox[{"-", "3"}], "*", "h", "*", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"\[Delta]", "^", "3"}], "+", 
        RowBox[{
         RowBox[{"\[Xi]", "^", "2"}], "*", "\[Delta]"}], "+", 
        RowBox[{"\[ImaginaryI]", "*", "\[Xi]", "*", 
         RowBox[{"\[Delta]", "^", "2"}]}], "+", 
        RowBox[{"\[ImaginaryI]", "*", 
         RowBox[{"\[Xi]", "^", "3"}]}]}], ")"}]}], ",", "0", ",", "0", ",", 
     "0"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sol", "=", 
   RowBox[{"Together", "[", 
    RowBox[{"Expand", "[", 
     RowBox[{"FullSimplify", "[", 
      RowBox[{"LinearSolve", "[", 
       RowBox[{"mat", ",", "vec"}], "]"}], "]"}], "]"}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", "\"\<z_2^3 monomial\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mat", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"3", "*", "\[Lambda]2"}], ",", 
       RowBox[{"-", "1"}], ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[Omega]", "^", "2"}], ",", 
       RowBox[{
        RowBox[{"3", "*", "\[Lambda]2"}], "+", 
        RowBox[{"2", "*", "\[Xi]", "*", "\[Omega]"}]}], ",", "0", ",", "0", 
       ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", 
       RowBox[{"-", "1"}], ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "1", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vec", "=", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{
      RowBox[{"-", "h"}], "*", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"\[Delta]", "+", 
         RowBox[{"\[ImaginaryI]", "*", "\[Xi]"}]}], ")"}], "^", "3"}]}], ",", 
     "0", ",", "0", ",", "0"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sol", "=", 
   RowBox[{"Together", "[", 
    RowBox[{"Expand", "[", 
     RowBox[{"FullSimplify", "[", 
      RowBox[{"LinearSolve", "[", 
       RowBox[{"mat", ",", "vec"}], "]"}], "]"}], "]"}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", "\"\<Global`*\>\"", "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.9051835395654583`*^9, 3.905183559375699*^9}, {
   3.905183595910876*^9, 3.90518386783629*^9}, {3.9051839806274157`*^9, 
   3.905183983931136*^9}, {3.9051863749162683`*^9, 3.905186388199192*^9}, {
   3.9051876988510923`*^9, 3.9051876999698753`*^9}, {3.9051878169167223`*^9, 
   3.9051878353562536`*^9}, {3.905191415031643*^9, 3.905191528256778*^9}, {
   3.9051916117462254`*^9, 3.905191659237344*^9}, {3.9051917036909885`*^9, 
   3.9051917050444508`*^9}, 3.905191779582781*^9, 3.9051918276133933`*^9, {
   3.90519213704762*^9, 3.90519216668962*^9}, {3.905192212867161*^9, 
   3.905192241741973*^9}, {3.905192287866684*^9, 3.9051923596652193`*^9}, {
   3.9051925320666723`*^9, 3.9051925336766186`*^9}, {3.9052380146695786`*^9, 
   3.9052380640932198`*^9}, {3.905238173991814*^9, 3.9052381777002935`*^9}, {
   3.9052393515340548`*^9, 3.905239351940651*^9}, {3.9052394169898224`*^9, 
   3.905239440918724*^9}, {3.9052396009931245`*^9, 3.9052396018614426`*^9}, {
   3.9052396529742746`*^9, 3.905239691077691*^9}, {3.9052397257393627`*^9, 
   3.9052399446495*^9}},
 CellLabel->
  "In[3302]:=",ExpressionUUID->"74947bcf-1700-47d9-884d-34c3cd0b9770"],

Cell[CellGroupData[{

Cell[BoxData["\<\"Order 1\"\>"], "Print",
 CellChangeTimes->{
  3.9052396044404907`*^9, {3.9052397665347815`*^9, 3.9052398210164366`*^9}, 
   3.9052398559955416`*^9, 3.905239945918919*^9},
 CellLabel->
  "During evaluation of \
In[3302]:=",ExpressionUUID->"51464f45-70a8-4027-a4c5-0bc0982467d1"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"W(z) = \"\>", "\[InvisibleSpace]", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", 
     TagBox[GridBox[{
        {
         RowBox[{"W11", "+", 
          RowBox[{"W12", " ", "z1"}], "+", 
          RowBox[{"W13", " ", "z2"}]}]},
        {
         RowBox[{"W21", "+", 
          RowBox[{"W22", " ", "z1"}], "+", 
          RowBox[{"W23", " ", "z2"}]}]},
        {
         RowBox[{"W31", "+", 
          RowBox[{"W32", " ", "z1"}], "+", 
          RowBox[{"W33", " ", "z2"}]}]}
       },
       GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}}],
      Column], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]}],
  SequenceForm["W(z) = ", 
   MatrixForm[{$CellContext`W11 + $CellContext`W12 $CellContext`z1 + \
$CellContext`W13 $CellContext`z2, $CellContext`W21 + $CellContext`W22 \
$CellContext`z1 + $CellContext`W23 $CellContext`z2, $CellContext`W31 + \
$CellContext`W32 $CellContext`z1 + $CellContext`W33 $CellContext`z2}]],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.9052396044404907`*^9, {3.9052397665347815`*^9, 3.9052398210164366`*^9}, 
   3.9052398559955416`*^9, 3.9052399459209185`*^9},
 CellLabel->
  "During evaluation of \
In[3302]:=",ExpressionUUID->"feebc075-17bf-4933-bce6-e4bb8dd0cfc3"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"f(z) = \"\>", "\[InvisibleSpace]", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", 
     TagBox[GridBox[{
        {
         RowBox[{"f11", "+", 
          RowBox[{"f12", " ", "z1"}], "+", 
          RowBox[{"f13", " ", "z2"}]}]},
        {
         RowBox[{"f21", "+", 
          RowBox[{"f22", " ", "z1"}], "+", 
          RowBox[{"f23", " ", "z2"}]}]}
       },
       GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}}],
      Column], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]}],
  SequenceForm["f(z) = ", 
   MatrixForm[{$CellContext`f11 + $CellContext`f12 $CellContext`z1 + \
$CellContext`f13 $CellContext`z2, $CellContext`f21 + $CellContext`f22 \
$CellContext`z1 + $CellContext`f23 $CellContext`z2}]],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.9052396044404907`*^9, {3.9052397665347815`*^9, 3.9052398210164366`*^9}, 
   3.9052398559955416`*^9, 3.9052399459269147`*^9},
 CellLabel->
  "During evaluation of \
In[3302]:=",ExpressionUUID->"2060cfc5-4a37-4815-852b-49dc909f10f9"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\[Del]W(z) = \"\>", "\[InvisibleSpace]", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"W12", "W13"},
       {"W22", "W23"},
       {"W32", "W33"}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]}],
  SequenceForm["\[Del]W(z) = ", 
   MatrixForm[{{$CellContext`W12, $CellContext`W13}, {$CellContext`W22, \
$CellContext`W23}, {$CellContext`W32, $CellContext`W33}}]],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.9052396044404907`*^9, {3.9052397665347815`*^9, 3.9052398210164366`*^9}, 
   3.9052398559955416`*^9, 3.905239945928915*^9},
 CellLabel->
  "During evaluation of \
In[3302]:=",ExpressionUUID->"b106c9e5-b38c-4de2-adb7-22945bc2c6fb"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Q(W(z)) = \"\>", "\[InvisibleSpace]", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", 
     TagBox[GridBox[{
        {"0"},
        {
         RowBox[{
          RowBox[{"-", "h"}], " ", 
          RowBox[{"(", 
           RowBox[{"W11", "+", 
            RowBox[{"W12", " ", "z1"}], "+", 
            RowBox[{"W13", " ", "z2"}]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{"W31", "+", 
            RowBox[{"W32", " ", "z1"}], "+", 
            RowBox[{"W33", " ", "z2"}]}], ")"}]}]},
        {
         RowBox[{"-", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"W11", "+", 
             RowBox[{"W12", " ", "z1"}], "+", 
             RowBox[{"W13", " ", "z2"}]}], ")"}], "2"]}]}
       },
       GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}}],
      Column], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]}],
  SequenceForm["Q(W(z)) = ", 
   MatrixForm[{
    0, -$CellContext`h ($CellContext`W11 + $CellContext`W12 $CellContext`z1 + \
$CellContext`W13 $CellContext`z2) ($CellContext`W31 + $CellContext`W32 \
$CellContext`z1 + $CellContext`W33 $CellContext`z2), -($CellContext`W11 + \
$CellContext`W12 $CellContext`z1 + $CellContext`W13 $CellContext`z2)^2}]],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.9052396044404907`*^9, {3.9052397665347815`*^9, 3.9052398210164366`*^9}, 
   3.9052398559955416`*^9, 3.9052399459309163`*^9},
 CellLabel->
  "During evaluation of \
In[3302]:=",ExpressionUUID->"9e68e59e-462d-4c2b-b024-8224762e120d"],

Cell[BoxData["\<\"B.gradW.f = A.W+Q\"\>"], "Print",
 CellChangeTimes->{
  3.9052396044404907`*^9, {3.9052397665347815`*^9, 3.9052398210164366`*^9}, 
   3.9052398559955416`*^9, 3.9052399459319143`*^9},
 CellLabel->
  "During evaluation of \
In[3302]:=",ExpressionUUID->"40ca4219-e388-4be4-8234-d03611040671"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   TagBox[
    RowBox[{"(", "\[NoBreak]", 
     TagBox[GridBox[{
        {
         RowBox[{
          RowBox[{"z2", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "\[ImaginaryI]"}], " ", 
              SuperscriptBox["\[Delta]", "2"], " ", "\[Omega]"}], "-", 
             RowBox[{"\[ImaginaryI]", " ", 
              SuperscriptBox["\[Xi]", "2"], " ", "\[Omega]"}]}], ")"}]}], "+", 
          RowBox[{"z1", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"\[ImaginaryI]", " ", 
              SuperscriptBox["\[Delta]", "2"], " ", "\[Omega]"}], "+", 
             RowBox[{"\[ImaginaryI]", " ", 
              SuperscriptBox["\[Xi]", "2"], " ", "\[Omega]"}]}], ")"}]}]}]},
        {
         RowBox[{
          RowBox[{"z1", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "\[Delta]"}], " ", 
              SuperscriptBox["\[Omega]", "2"]}], "-", 
             RowBox[{"\[ImaginaryI]", " ", "\[Xi]", " ", 
              SuperscriptBox["\[Omega]", "2"]}]}], ")"}]}], "+", 
          RowBox[{"z2", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "\[Delta]"}], " ", 
              SuperscriptBox["\[Omega]", "2"]}], "+", 
             RowBox[{"\[ImaginaryI]", " ", "\[Xi]", " ", 
              SuperscriptBox["\[Omega]", "2"]}]}], ")"}]}]}]},
        {"0"}
       },
       GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}}],
      Column], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], "\[InvisibleSpace]", "\<\" = \"\>", 
   "\[InvisibleSpace]", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", 
     TagBox[GridBox[{
        {
         RowBox[{
          RowBox[{"\[ImaginaryI]", " ", "z1", " ", "\[Omega]"}], "-", 
          RowBox[{"\[ImaginaryI]", " ", "z2", " ", "\[Omega]"}]}]},
        {
         RowBox[{
          RowBox[{"z1", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "\[Delta]"}], " ", 
              SuperscriptBox["\[Omega]", "2"]}], "-", 
             RowBox[{"\[ImaginaryI]", " ", "\[Xi]", " ", 
              SuperscriptBox["\[Omega]", "2"]}]}], ")"}]}], "+", 
          RowBox[{"z2", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "\[Delta]"}], " ", 
              SuperscriptBox["\[Omega]", "2"]}], "+", 
             RowBox[{"\[ImaginaryI]", " ", "\[Xi]", " ", 
              SuperscriptBox["\[Omega]", "2"]}]}], ")"}]}]}]},
        {"0"}
       },
       GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}}],
      Column], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]}],
  SequenceForm[
   MatrixForm[{$CellContext`z2 (
       Complex[0, -1] $CellContext`\[Delta]^2 $CellContext`\[Omega] + 
       Complex[0, -1] $CellContext`\[Xi]^2 $CellContext`\[Omega]) + \
$CellContext`z1 (Complex[0, 1] $CellContext`\[Delta]^2 $CellContext`\[Omega] + 
       Complex[0, 
          1] $CellContext`\[Xi]^2 $CellContext`\[Omega]), $CellContext`z1 \
(-$CellContext`\[Delta] $CellContext`\[Omega]^2 + 
       Complex[0, -1] $CellContext`\[Xi] $CellContext`\[Omega]^2) + \
$CellContext`z2 (-$CellContext`\[Delta] $CellContext`\[Omega]^2 + 
       Complex[0, 1] $CellContext`\[Xi] $CellContext`\[Omega]^2), 0}], " = ", 
   MatrixForm[{
    Complex[0, 1] $CellContext`z1 $CellContext`\[Omega] + 
     Complex[0, -1] $CellContext`z2 $CellContext`\[Omega], $CellContext`z1 \
(-$CellContext`\[Delta] $CellContext`\[Omega]^2 + 
       Complex[0, -1] $CellContext`\[Xi] $CellContext`\[Omega]^2) + \
$CellContext`z2 (-$CellContext`\[Delta] $CellContext`\[Omega]^2 + 
       Complex[0, 1] $CellContext`\[Xi] $CellContext`\[Omega]^2), 0}]],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.9052396044404907`*^9, {3.9052397665347815`*^9, 3.9052398210164366`*^9}, 
   3.9052398559955416`*^9, 3.9052399459349146`*^9},
 CellLabel->
  "During evaluation of \
In[3302]:=",ExpressionUUID->"64eda1a4-6a9a-4ac6-bf68-ccd4d069d10e"],

Cell[BoxData["\<\"OK\"\>"], "Print",
 CellChangeTimes->{
  3.9052396044404907`*^9, {3.9052397665347815`*^9, 3.9052398210164366`*^9}, 
   3.9052398559955416`*^9, 3.9052399459369144`*^9},
 CellLabel->
  "During evaluation of \
In[3302]:=",ExpressionUUID->"2ab9539c-d451-4ebf-a187-8f454bc37309"],

Cell[BoxData["\<\"Nonlinear mappings\"\>"], "Print",
 CellChangeTimes->{
  3.9052396044404907`*^9, {3.9052397665347815`*^9, 3.9052398210164366`*^9}, 
   3.9052398559955416`*^9, 3.905239945937914*^9},
 CellLabel->
  "During evaluation of \
In[3302]:=",ExpressionUUID->"17a8f4d2-7768-4c9f-a12d-2fa44ff739f7"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"u = \"\>", "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "\[ImaginaryI]"}], " ", "z2", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"\[ImaginaryI]", " ", "\[Delta]"}], "-", "\[Xi]"}], ")"}]}], 
    "-", 
    RowBox[{"\[ImaginaryI]", " ", "z1", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"\[ImaginaryI]", " ", "\[Delta]"}], "+", "\[Xi]"}], ")"}]}]}]}],
  SequenceForm[
  "u = ", Complex[0, -1] $CellContext`z2 (
     Complex[0, 1] $CellContext`\[Delta] - $CellContext`\[Xi]) + 
   Complex[0, -1] $CellContext`z1 (
     Complex[0, 1] $CellContext`\[Delta] + $CellContext`\[Xi])],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.9052396044404907`*^9, {3.9052397665347815`*^9, 3.9052398210164366`*^9}, 
   3.9052398559955416`*^9, 3.905239945939012*^9},
 CellLabel->
  "During evaluation of \
In[3302]:=",ExpressionUUID->"a5b6ded4-3c66-4c4b-ab62-867e64ab6939"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"v = \"\>", "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{"\[ImaginaryI]", " ", "z1", " ", "\[Omega]"}], "-", 
    RowBox[{"\[ImaginaryI]", " ", "z2", " ", "\[Omega]"}]}]}],
  SequenceForm[
  "v = ", Complex[0, 1] $CellContext`z1 $CellContext`\[Omega] + 
   Complex[0, -1] $CellContext`z2 $CellContext`\[Omega]],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.9052396044404907`*^9, {3.9052397665347815`*^9, 3.9052398210164366`*^9}, 
   3.9052398559955416`*^9, 3.905239945940958*^9},
 CellLabel->
  "During evaluation of \
In[3302]:=",ExpressionUUID->"a73b6435-0249-4e90-b34f-265fed334404"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"r = \"\>", "\[InvisibleSpace]", "0"}],
  SequenceForm["r = ", 0],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.9052396044404907`*^9, {3.9052397665347815`*^9, 3.9052398210164366`*^9}, 
   3.9052398559955416`*^9, 3.9052399459419823`*^9},
 CellLabel->
  "During evaluation of \
In[3302]:=",ExpressionUUID->"97e5b519-34f2-44bb-b9f7-b92a67e2fdd7"],

Cell[BoxData["\<\"Reduced dynamics\"\>"], "Print",
 CellChangeTimes->{
  3.9052396044404907`*^9, {3.9052397665347815`*^9, 3.9052398210164366`*^9}, 
   3.9052398559955416`*^9, 3.9052399459439197`*^9},
 CellLabel->
  "During evaluation of \
In[3302]:=",ExpressionUUID->"bcd5c9ed-3f06-46e7-9bff-cec655f19302"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"dz1dt = \"\>", "\[InvisibleSpace]", 
   RowBox[{"z1", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"\[ImaginaryI]", " ", "\[Delta]"}], "-", "\[Xi]"}], ")"}], " ", 
    "\[Omega]"}]}],
  SequenceForm[
  "dz1dt = ", $CellContext`z1 (
    Complex[0, 
       1] $CellContext`\[Delta] - $CellContext`\[Xi]) $CellContext`\[Omega]],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.9052396044404907`*^9, {3.9052397665347815`*^9, 3.9052398210164366`*^9}, 
   3.9052398559955416`*^9, 3.905239945944916*^9},
 CellLabel->
  "During evaluation of \
In[3302]:=",ExpressionUUID->"9ded82ce-41d0-47b3-84c3-d2d31ef88aa5"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"dz2dt = \"\>", "\[InvisibleSpace]", 
   RowBox[{"z2", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "\[ImaginaryI]"}], " ", "\[Delta]"}], "-", "\[Xi]"}], 
     ")"}], " ", "\[Omega]"}]}],
  SequenceForm[
  "dz2dt = ", $CellContext`z2 (
    Complex[0, -1] $CellContext`\[Delta] - $CellContext`\[Xi]) $CellContext`\
\[Omega]],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.9052396044404907`*^9, {3.9052397665347815`*^9, 3.9052398210164366`*^9}, 
   3.9052398559955416`*^9, 3.9052399459459143`*^9},
 CellLabel->
  "During evaluation of \
In[3302]:=",ExpressionUUID->"22a0aff2-0b5a-4113-95f3-f4710b0196cf"],

Cell[BoxData["\<\"Order 2\"\>"], "Print",
 CellChangeTimes->{
  3.9052396044404907`*^9, {3.9052397665347815`*^9, 3.9052398210164366`*^9}, 
   3.9052398559955416`*^9, 3.905239945947914*^9},
 CellLabel->
  "During evaluation of \
In[3302]:=",ExpressionUUID->"f622ff60-b057-4d6d-be74-8b9cc81a34a3"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"W(z) = \"\>", "\[InvisibleSpace]", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", 
     TagBox[GridBox[{
        {
         RowBox[{
          RowBox[{"W14", " ", 
           SuperscriptBox["z1", "2"]}], "+", 
          RowBox[{"W15", " ", "z1", " ", "z2"}], "+", 
          RowBox[{"W16", " ", 
           SuperscriptBox["z2", "2"]}], "-", 
          RowBox[{"\[ImaginaryI]", " ", "z2", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"\[ImaginaryI]", " ", "\[Delta]"}], "-", "\[Xi]"}], 
            ")"}]}], "-", 
          RowBox[{"\[ImaginaryI]", " ", "z1", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"\[ImaginaryI]", " ", "\[Delta]"}], "+", "\[Xi]"}], 
            ")"}]}]}]},
        {
         RowBox[{
          RowBox[{"W24", " ", 
           SuperscriptBox["z1", "2"]}], "+", 
          RowBox[{"W25", " ", "z1", " ", "z2"}], "+", 
          RowBox[{"W26", " ", 
           SuperscriptBox["z2", "2"]}], "+", 
          RowBox[{"\[ImaginaryI]", " ", "z1", " ", "\[Omega]"}], "-", 
          RowBox[{"\[ImaginaryI]", " ", "z2", " ", "\[Omega]"}]}]},
        {
         RowBox[{
          RowBox[{"W34", " ", 
           SuperscriptBox["z1", "2"]}], "+", 
          RowBox[{"W35", " ", "z1", " ", "z2"}], "+", 
          RowBox[{"W36", " ", 
           SuperscriptBox["z2", "2"]}]}]}
       },
       GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}}],
      Column], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]}],
  SequenceForm["W(z) = ", 
   MatrixForm[{$CellContext`W14 $CellContext`z1^2 + $CellContext`W15 \
$CellContext`z1 $CellContext`z2 + $CellContext`W16 $CellContext`z2^2 + 
     Complex[0, -1] $CellContext`z2 (
       Complex[0, 1] $CellContext`\[Delta] - $CellContext`\[Xi]) + 
     Complex[0, -1] $CellContext`z1 (
       Complex[0, 
          1] $CellContext`\[Delta] + $CellContext`\[Xi]), $CellContext`W24 \
$CellContext`z1^2 + $CellContext`W25 $CellContext`z1 $CellContext`z2 + \
$CellContext`W26 $CellContext`z2^2 + 
     Complex[0, 1] $CellContext`z1 $CellContext`\[Omega] + 
     Complex[0, -1] $CellContext`z2 $CellContext`\[Omega], $CellContext`W34 \
$CellContext`z1^2 + $CellContext`W35 $CellContext`z1 $CellContext`z2 + \
$CellContext`W36 $CellContext`z2^2}]],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.9052396044404907`*^9, {3.9052397665347815`*^9, 3.9052398210164366`*^9}, 
   3.9052398559955416`*^9, 3.905239945949936*^9},
 CellLabel->
  "During evaluation of \
In[3302]:=",ExpressionUUID->"74f0bc0e-74cb-4737-8579-9ecbc1349718"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"f(z) = \"\>", "\[InvisibleSpace]", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", 
     TagBox[GridBox[{
        {
         RowBox[{
          RowBox[{"f14", " ", 
           SuperscriptBox["z1", "2"]}], "+", 
          RowBox[{"f15", " ", "z1", " ", "z2"}], "+", 
          RowBox[{"f16", " ", 
           SuperscriptBox["z2", "2"]}], "+", 
          RowBox[{"z1", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"\[ImaginaryI]", " ", "\[Delta]"}], "-", "\[Xi]"}], 
            ")"}], " ", "\[Omega]"}]}]},
        {
         RowBox[{
          RowBox[{"f24", " ", 
           SuperscriptBox["z1", "2"]}], "+", 
          RowBox[{"f25", " ", "z1", " ", "z2"}], "+", 
          RowBox[{"f26", " ", 
           SuperscriptBox["z2", "2"]}], "+", 
          RowBox[{"z2", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "\[ImaginaryI]"}], " ", "\[Delta]"}], "-", 
             "\[Xi]"}], ")"}], " ", "\[Omega]"}]}]}
       },
       GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}}],
      Column], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]}],
  SequenceForm["f(z) = ", 
   MatrixForm[{$CellContext`f14 $CellContext`z1^2 + $CellContext`f15 \
$CellContext`z1 $CellContext`z2 + $CellContext`f16 $CellContext`z2^2 + \
$CellContext`z1 (
       Complex[0, 
          1] $CellContext`\[Delta] - $CellContext`\[Xi]) \
$CellContext`\[Omega], $CellContext`f24 $CellContext`z1^2 + $CellContext`f25 \
$CellContext`z1 $CellContext`z2 + $CellContext`f26 $CellContext`z2^2 + \
$CellContext`z2 (
       Complex[0, -1] $CellContext`\[Delta] - $CellContext`\[Xi]) \
$CellContext`\[Omega]}]],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.9052396044404907`*^9, {3.9052397665347815`*^9, 3.9052398210164366`*^9}, 
   3.9052398559955416`*^9, 3.9052399459519353`*^9},
 CellLabel->
  "During evaluation of \
In[3302]:=",ExpressionUUID->"a548e540-bc22-4f9a-ab51-8be7e90fb8f9"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\[Del]W(z) = \"\>", "\[InvisibleSpace]", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {
        RowBox[{
         RowBox[{"2", " ", "W14", " ", "z1"}], "+", 
         RowBox[{"W15", " ", "z2"}], "-", 
         RowBox[{"\[ImaginaryI]", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[ImaginaryI]", " ", "\[Delta]"}], "+", "\[Xi]"}], 
           ")"}]}]}], 
        RowBox[{
         RowBox[{"W15", " ", "z1"}], "+", 
         RowBox[{"2", " ", "W16", " ", "z2"}], "-", 
         RowBox[{"\[ImaginaryI]", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[ImaginaryI]", " ", "\[Delta]"}], "-", "\[Xi]"}], 
           ")"}]}]}]},
       {
        RowBox[{
         RowBox[{"2", " ", "W24", " ", "z1"}], "+", 
         RowBox[{"W25", " ", "z2"}], "+", 
         RowBox[{"\[ImaginaryI]", " ", "\[Omega]"}]}], 
        RowBox[{
         RowBox[{"W25", " ", "z1"}], "+", 
         RowBox[{"2", " ", "W26", " ", "z2"}], "-", 
         RowBox[{"\[ImaginaryI]", " ", "\[Omega]"}]}]},
       {
        RowBox[{
         RowBox[{"2", " ", "W34", " ", "z1"}], "+", 
         RowBox[{"W35", " ", "z2"}]}], 
        RowBox[{
         RowBox[{"W35", " ", "z1"}], "+", 
         RowBox[{"2", " ", "W36", " ", "z2"}]}]}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]}],
  SequenceForm["\[Del]W(z) = ", 
   MatrixForm[{{
     2 $CellContext`W14 $CellContext`z1 + $CellContext`W15 $CellContext`z2 + 
      Complex[0, -1] (
        Complex[0, 
           1] $CellContext`\[Delta] + $CellContext`\[Xi]), $CellContext`W15 \
$CellContext`z1 + 2 $CellContext`W16 $CellContext`z2 + 
      Complex[0, -1] (
        Complex[0, 1] $CellContext`\[Delta] - $CellContext`\[Xi])}, {
     2 $CellContext`W24 $CellContext`z1 + $CellContext`W25 $CellContext`z2 + 
      Complex[0, 1] $CellContext`\[Omega], $CellContext`W25 $CellContext`z1 + 
      2 $CellContext`W26 $CellContext`z2 + 
      Complex[0, -1] $CellContext`\[Omega]}, {
     2 $CellContext`W34 $CellContext`z1 + $CellContext`W35 $CellContext`z2, \
$CellContext`W35 $CellContext`z1 + 2 $CellContext`W36 $CellContext`z2}}]],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.9052396044404907`*^9, {3.9052397665347815`*^9, 3.9052398210164366`*^9}, 
   3.9052398559955416`*^9, 3.905239945954933*^9},
 CellLabel->
  "During evaluation of \
In[3302]:=",ExpressionUUID->"6d8d8a47-4445-4745-a432-fb954a4da721"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Q(W(z)) = \"\>", "\[InvisibleSpace]", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", 
     TagBox[GridBox[{
        {"0"},
        {
         RowBox[{
          RowBox[{"-", "h"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"W34", " ", 
             SuperscriptBox["z1", "2"]}], "+", 
            RowBox[{"W35", " ", "z1", " ", "z2"}], "+", 
            RowBox[{"W36", " ", 
             SuperscriptBox["z2", "2"]}]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"W14", " ", 
             SuperscriptBox["z1", "2"]}], "+", 
            RowBox[{"W15", " ", "z1", " ", "z2"}], "+", 
            RowBox[{"W16", " ", 
             SuperscriptBox["z2", "2"]}], "-", 
            RowBox[{"\[ImaginaryI]", " ", "z2", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"\[ImaginaryI]", " ", "\[Delta]"}], "-", "\[Xi]"}], 
              ")"}]}], "-", 
            RowBox[{"\[ImaginaryI]", " ", "z1", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"\[ImaginaryI]", " ", "\[Delta]"}], "+", "\[Xi]"}], 
              ")"}]}]}], ")"}]}]},
        {
         RowBox[{"-", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"W14", " ", 
              SuperscriptBox["z1", "2"]}], "+", 
             RowBox[{"W15", " ", "z1", " ", "z2"}], "+", 
             RowBox[{"W16", " ", 
              SuperscriptBox["z2", "2"]}], "-", 
             RowBox[{"\[ImaginaryI]", " ", "z2", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"\[ImaginaryI]", " ", "\[Delta]"}], "-", "\[Xi]"}], 
               ")"}]}], "-", 
             RowBox[{"\[ImaginaryI]", " ", "z1", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"\[ImaginaryI]", " ", "\[Delta]"}], "+", "\[Xi]"}], 
               ")"}]}]}], ")"}], "2"]}]}
       },
       GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}}],
      Column], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]}],
  SequenceForm["Q(W(z)) = ", 
   MatrixForm[{
    0, -$CellContext`h ($CellContext`W34 $CellContext`z1^2 + $CellContext`W35 \
$CellContext`z1 $CellContext`z2 + $CellContext`W36 $CellContext`z2^2) \
($CellContext`W14 $CellContext`z1^2 + $CellContext`W15 $CellContext`z1 \
$CellContext`z2 + $CellContext`W16 $CellContext`z2^2 + 
      Complex[0, -1] $CellContext`z2 (
        Complex[0, 1] $CellContext`\[Delta] - $CellContext`\[Xi]) + 
      Complex[0, -1] $CellContext`z1 (
        Complex[0, 
           1] $CellContext`\[Delta] + $CellContext`\[Xi])), \
-($CellContext`W14 $CellContext`z1^2 + $CellContext`W15 $CellContext`z1 \
$CellContext`z2 + $CellContext`W16 $CellContext`z2^2 + 
       Complex[0, -1] $CellContext`z2 (
         Complex[0, 1] $CellContext`\[Delta] - $CellContext`\[Xi]) + 
       Complex[0, -1] $CellContext`z1 (
         Complex[0, 1] $CellContext`\[Delta] + $CellContext`\[Xi]))^2}]],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.9052396044404907`*^9, {3.9052397665347815`*^9, 3.9052398210164366`*^9}, 
   3.9052398559955416`*^9, 3.9052399459599147`*^9},
 CellLabel->
  "During evaluation of \
In[3302]:=",ExpressionUUID->"4e4e2b7d-28e8-4e21-aa17-0ae5dfd51dd7"],

Cell[BoxData["\<\"B.gradW.f = A.W+Q\"\>"], "Print",
 CellChangeTimes->{
  3.9052396044404907`*^9, {3.9052397665347815`*^9, 3.9052398210164366`*^9}, 
   3.9052398559955416`*^9, 3.905239945961915*^9},
 CellLabel->
  "During evaluation of \
In[3302]:=",ExpressionUUID->"4c496ea6-76d1-4812-aa7d-c83198aa265a"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   TagBox[
    RowBox[{"(", "\[NoBreak]", 
     TagBox[GridBox[{
        {
         RowBox[{
          RowBox[{
           RowBox[{"-", "2"}], " ", "W15", " ", "z1", " ", "z2", " ", "\[Xi]",
            " ", "\[Omega]"}], "+", 
          RowBox[{
           SuperscriptBox["z1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
             "2", " ", "\[ImaginaryI]", " ", "W14", " ", "\[Delta]", " ", 
              "\[Omega]"}], "-", 
             RowBox[{"2", " ", "W14", " ", "\[Xi]", " ", "\[Omega]"}]}], 
            ")"}]}], "+", 
          RowBox[{
           SuperscriptBox["z2", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "2"}], " ", "\[ImaginaryI]", " ", "W16", " ", 
              "\[Delta]", " ", "\[Omega]"}], "-", 
             RowBox[{"2", " ", "W16", " ", "\[Xi]", " ", "\[Omega]"}]}], 
            ")"}]}]}]},
        {
         RowBox[{
          RowBox[{
           RowBox[{"-", "2"}], " ", "W25", " ", "z1", " ", "z2", " ", "\[Xi]",
            " ", "\[Omega]"}], "+", 
          RowBox[{
           SuperscriptBox["z1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
             "2", " ", "\[ImaginaryI]", " ", "W24", " ", "\[Delta]", " ", 
              "\[Omega]"}], "-", 
             RowBox[{"2", " ", "W24", " ", "\[Xi]", " ", "\[Omega]"}]}], 
            ")"}]}], "+", 
          RowBox[{
           SuperscriptBox["z2", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "2"}], " ", "\[ImaginaryI]", " ", "W26", " ", 
              "\[Delta]", " ", "\[Omega]"}], "-", 
             RowBox[{"2", " ", "W26", " ", "\[Xi]", " ", "\[Omega]"}]}], 
            ")"}]}]}]},
        {"0"}
       },
       GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}}],
      Column], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], "\[InvisibleSpace]", "\<\" = \"\>", 
   "\[InvisibleSpace]", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", 
     TagBox[GridBox[{
        {
         RowBox[{
          RowBox[{"W24", " ", 
           SuperscriptBox["z1", "2"]}], "+", 
          RowBox[{"W25", " ", "z1", " ", "z2"}], "+", 
          RowBox[{"W26", " ", 
           SuperscriptBox["z2", "2"]}]}]},
        {
         RowBox[{
          RowBox[{
           SuperscriptBox["z1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "2"}], " ", "W24", " ", "\[Xi]", " ", "\[Omega]"}],
              "-", 
             RowBox[{"W14", " ", 
              SuperscriptBox["\[Omega]", "2"]}]}], ")"}]}], "+", 
          RowBox[{"z1", " ", "z2", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "2"}], " ", "W25", " ", "\[Xi]", " ", "\[Omega]"}],
              "-", 
             RowBox[{"W15", " ", 
              SuperscriptBox["\[Omega]", "2"]}]}], ")"}]}], "+", 
          RowBox[{
           SuperscriptBox["z2", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "2"}], " ", "W26", " ", "\[Xi]", " ", "\[Omega]"}],
              "-", 
             RowBox[{"W16", " ", 
              SuperscriptBox["\[Omega]", "2"]}]}], ")"}]}]}]},
        {
         RowBox[{
          RowBox[{"z1", " ", "z2", " ", 
           RowBox[{"(", 
            RowBox[{"W35", "-", 
             RowBox[{"2", " ", 
              SuperscriptBox["\[Delta]", "2"]}], "-", 
             RowBox[{"2", " ", 
              SuperscriptBox["\[Xi]", "2"]}]}], ")"}]}], "+", 
          RowBox[{
           SuperscriptBox["z2", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"W36", "-", 
             SuperscriptBox["\[Delta]", "2"], "-", 
             RowBox[{
             "2", " ", "\[ImaginaryI]", " ", "\[Delta]", " ", "\[Xi]"}], "+", 
             SuperscriptBox["\[Xi]", "2"]}], ")"}]}], "+", 
          RowBox[{
           SuperscriptBox["z1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"W34", "-", 
             SuperscriptBox["\[Delta]", "2"], "+", 
             RowBox[{
             "2", " ", "\[ImaginaryI]", " ", "\[Delta]", " ", "\[Xi]"}], "+", 
             SuperscriptBox["\[Xi]", "2"]}], ")"}]}]}]}
       },
       GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}}],
      Column], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]}],
  SequenceForm[
   MatrixForm[{(-2) $CellContext`W15 $CellContext`z1 $CellContext`z2 \
$CellContext`\[Xi] $CellContext`\[Omega] + $CellContext`z1^2 (
       Complex[0, 
          2] $CellContext`W14 $CellContext`\[Delta] $CellContext`\[Omega] - 
       2 $CellContext`W14 $CellContext`\[Xi] $CellContext`\[Omega]) + \
$CellContext`z2^2 (
       Complex[0, -2] $CellContext`W16 $CellContext`\[Delta] $CellContext`\
\[Omega] - 
       2 $CellContext`W16 $CellContext`\[Xi] $CellContext`\[Omega]), (-2) \
$CellContext`W25 $CellContext`z1 $CellContext`z2 $CellContext`\[Xi] \
$CellContext`\[Omega] + $CellContext`z1^2 (
       Complex[0, 
          2] $CellContext`W24 $CellContext`\[Delta] $CellContext`\[Omega] - 
       2 $CellContext`W24 $CellContext`\[Xi] $CellContext`\[Omega]) + \
$CellContext`z2^2 (
       Complex[0, -2] $CellContext`W26 $CellContext`\[Delta] $CellContext`\
\[Omega] - 2 $CellContext`W26 $CellContext`\[Xi] $CellContext`\[Omega]), 0}], 
   " = ", 
   MatrixForm[{$CellContext`W24 $CellContext`z1^2 + $CellContext`W25 \
$CellContext`z1 $CellContext`z2 + $CellContext`W26 $CellContext`z2^2, \
$CellContext`z1^2 ((-2) $CellContext`W24 $CellContext`\[Xi] $CellContext`\
\[Omega] - $CellContext`W14 $CellContext`\[Omega]^2) + $CellContext`z1 \
$CellContext`z2 ((-2) $CellContext`W25 $CellContext`\[Xi] $CellContext`\
\[Omega] - $CellContext`W15 $CellContext`\[Omega]^2) + $CellContext`z2^2 \
((-2) $CellContext`W26 $CellContext`\[Xi] $CellContext`\[Omega] - \
$CellContext`W16 $CellContext`\[Omega]^2), $CellContext`z1 $CellContext`z2 \
($CellContext`W35 - 2 $CellContext`\[Delta]^2 - 
       2 $CellContext`\[Xi]^2) + $CellContext`z2^2 ($CellContext`W36 - \
$CellContext`\[Delta]^2 + 
       Complex[0, -2] $CellContext`\[Delta] $CellContext`\[Xi] + \
$CellContext`\[Xi]^2) + $CellContext`z1^2 ($CellContext`W34 - $CellContext`\
\[Delta]^2 + 
       Complex[0, 
          2] $CellContext`\[Delta] $CellContext`\[Xi] + \
$CellContext`\[Xi]^2)}]],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.9052396044404907`*^9, {3.9052397665347815`*^9, 3.9052398210164366`*^9}, 
   3.9052398559955416`*^9, 3.905239945965914*^9},
 CellLabel->
  "During evaluation of \
In[3302]:=",ExpressionUUID->"0289f70c-2edc-4af6-a1a1-b6ecac301063"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"W34 = \"\>", "\[InvisibleSpace]", 
   RowBox[{"-", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"\[ImaginaryI]", " ", "\[Delta]"}], "+", "\[Xi]"}], ")"}], 
     "2"]}], "\[InvisibleSpace]", "\<\", W35 = \"\>", "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{"-", "2"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"\[ImaginaryI]", " ", "\[Delta]"}], "-", "\[Xi]"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"\[ImaginaryI]", " ", "\[Delta]"}], "+", "\[Xi]"}], ")"}]}], 
   "\[InvisibleSpace]", "\<\", W36 = \"\>", "\[InvisibleSpace]", 
   RowBox[{"-", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"\[ImaginaryI]", " ", "\[Delta]"}], "-", "\[Xi]"}], ")"}], 
     "2"]}]}],
  SequenceForm[
  "W34 = ", -(Complex[0, 1] $CellContext`\[Delta] + $CellContext`\[Xi])^2, 
   ", W35 = ", (-2) (
    Complex[0, 1] $CellContext`\[Delta] - $CellContext`\[Xi]) (
    Complex[0, 1] $CellContext`\[Delta] + $CellContext`\[Xi]), 
   ", W36 = ", -(Complex[0, 1] $CellContext`\[Delta] - $CellContext`\[Xi])^2],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.9052396044404907`*^9, {3.9052397665347815`*^9, 3.9052398210164366`*^9}, 
   3.9052398559955416`*^9, 3.9052399459679155`*^9},
 CellLabel->
  "During evaluation of \
In[3302]:=",ExpressionUUID->"97aa5d68-67cd-4f88-9f94-338bfafd3c47"],

Cell[BoxData["\<\"W14 = W15 = W16 = W24 = W25 = W26 = 0\"\>"], "Print",
 CellChangeTimes->{
  3.9052396044404907`*^9, {3.9052397665347815`*^9, 3.9052398210164366`*^9}, 
   3.9052398559955416`*^9, 3.905239945969915*^9},
 CellLabel->
  "During evaluation of \
In[3302]:=",ExpressionUUID->"fa613454-4cb5-4f4c-b1a4-90c5c08a8257"],

Cell[BoxData["\<\"Checking the solution\"\>"], "Print",
 CellChangeTimes->{
  3.9052396044404907`*^9, {3.9052397665347815`*^9, 3.9052398210164366`*^9}, 
   3.9052398559955416`*^9, 3.9052399459709144`*^9},
 CellLabel->
  "During evaluation of \
In[3302]:=",ExpressionUUID->"073246c7-ed14-411a-a978-2da8264620a1"],

Cell[BoxData["\<\"B.gradW.f = A.W+Q\"\>"], "Print",
 CellChangeTimes->{
  3.9052396044404907`*^9, {3.9052397665347815`*^9, 3.9052398210164366`*^9}, 
   3.9052398559955416`*^9, 3.905239945971915*^9},
 CellLabel->
  "During evaluation of \
In[3302]:=",ExpressionUUID->"b91329b3-2d0d-4d24-867e-18127a30d822"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   TagBox[
    RowBox[{"(", "\[NoBreak]", 
     TagBox[GridBox[{
        {"0"},
        {"0"},
        {"0"}
       },
       GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}}],
      Column], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], "\[InvisibleSpace]", "\<\" = \"\>", 
   "\[InvisibleSpace]", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", 
     TagBox[GridBox[{
        {"0"},
        {"0"},
        {"0"}
       },
       GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}}],
      Column], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]}],
  SequenceForm[
   MatrixForm[{0, 0, 0}], " = ", 
   MatrixForm[{0, 0, 0}]],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.9052396044404907`*^9, {3.9052397665347815`*^9, 3.9052398210164366`*^9}, 
   3.9052398559955416`*^9, 3.9052399459739156`*^9},
 CellLabel->
  "During evaluation of \
In[3302]:=",ExpressionUUID->"53333c94-30ff-4ff8-a395-c0761635d04c"],

Cell[BoxData["\<\"OK\"\>"], "Print",
 CellChangeTimes->{
  3.9052396044404907`*^9, {3.9052397665347815`*^9, 3.9052398210164366`*^9}, 
   3.9052398559955416`*^9, 3.9052399459749155`*^9},
 CellLabel->
  "During evaluation of \
In[3302]:=",ExpressionUUID->"d493b289-d19b-4c49-be86-14dba7bb5055"],

Cell[BoxData["\<\"Solving for order 3 coefficients\"\>"], "Print",
 CellChangeTimes->{
  3.9052396044404907`*^9, {3.9052397665347815`*^9, 3.9052398210164366`*^9}, 
   3.9052398559955416`*^9, 3.905239945975916*^9},
 CellLabel->
  "During evaluation of \
In[3302]:=",ExpressionUUID->"8775e021-dc6e-437b-a76d-5f0b270eb95a"],

Cell[BoxData["\<\"z_1^3 monomial\"\>"], "Print",
 CellChangeTimes->{
  3.9052396044404907`*^9, {3.9052397665347815`*^9, 3.9052398210164366`*^9}, 
   3.9052398559955416`*^9, 3.9052399459779153`*^9},
 CellLabel->
  "During evaluation of \
In[3302]:=",ExpressionUUID->"b0a99f22-e1df-41d2-8c9d-6ac67bcce512"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox[
    RowBox[{
     RowBox[{
      RowBox[{"-", "3"}], " ", "h", " ", "\[Xi]"}], "+", 
     RowBox[{"4", " ", "h", " ", 
      SuperscriptBox["\[Xi]", "3"]}], "-", 
     RowBox[{"\[ImaginaryI]", " ", "h", " ", 
      SqrtBox[
       RowBox[{"1", "-", 
        SuperscriptBox["\[Xi]", "2"]}]]}], "+", 
     RowBox[{"4", " ", "\[ImaginaryI]", " ", "h", " ", 
      SuperscriptBox["\[Xi]", "2"], " ", 
      SqrtBox[
       RowBox[{"1", "-", 
        SuperscriptBox["\[Xi]", "2"]}]]}]}], 
    RowBox[{"4", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "2"}], " ", "\[ImaginaryI]"}], "+", 
       RowBox[{"3", " ", "\[ImaginaryI]", " ", 
        SuperscriptBox["\[Xi]", "2"]}], "+", 
       RowBox[{"3", " ", "\[Xi]", " ", 
        SqrtBox[
         RowBox[{"1", "-", 
          SuperscriptBox["\[Xi]", "2"]}]]}]}], ")"}], " ", 
     SuperscriptBox["\[Omega]", "2"]}]], ",", 
   FractionBox[
    RowBox[{"3", " ", 
     RowBox[{"(", 
      RowBox[{"h", "-", 
       RowBox[{"2", " ", "h", " ", 
        SuperscriptBox["\[Xi]", "2"]}], "-", 
       RowBox[{"2", " ", "\[ImaginaryI]", " ", "h", " ", "\[Xi]", " ", 
        SqrtBox[
         RowBox[{"1", "-", 
          SuperscriptBox["\[Xi]", "2"]}]]}]}], ")"}]}], 
    RowBox[{"4", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "2"}], " ", "\[ImaginaryI]"}], "+", 
       RowBox[{"3", " ", "\[ImaginaryI]", " ", 
        SuperscriptBox["\[Xi]", "2"]}], "+", 
       RowBox[{"3", " ", "\[Xi]", " ", 
        SqrtBox[
         RowBox[{"1", "-", 
          SuperscriptBox["\[Xi]", "2"]}]]}]}], ")"}], " ", "\[Omega]"}]], ",",
    "0", ",", "0", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{{3.90518384230949*^9, 3.905183868412505*^9}, 
   3.905183984897805*^9, {3.9051863757463455`*^9, 3.90518638912935*^9}, 
   3.9051877004899483`*^9, {3.9051878215653667`*^9, 3.905187836196182*^9}, 
   3.9051917071513376`*^9, 3.9051917806781416`*^9, 3.9051918285106964`*^9, {
   3.905192139171782*^9, 3.905192167613685*^9}, {3.9051922308591366`*^9, 
   3.905192242665907*^9}, {3.905192290185226*^9, 3.9051923608500986`*^9}, 
   3.9051925344602814`*^9, 3.905193152822033*^9, {3.9052380483114815`*^9, 
   3.9052380655522995`*^9}, 3.905238178056238*^9, 3.905239441217461*^9, 
   3.905239604567486*^9, {3.9052397665987825`*^9, 3.9052398210804973`*^9}, 
   3.9052398560525417`*^9, 3.9052399459799156`*^9},
 CellLabel->
  "Out[3375]=",ExpressionUUID->"4d9d0c51-dd07-4e3b-9f39-8da12935a62c"],

Cell[BoxData["\<\"z_1^2*z_2 monomial\"\>"], "Print",
 CellChangeTimes->{
  3.9052396044404907`*^9, {3.9052397665347815`*^9, 3.9052398210164366`*^9}, 
   3.9052398559955416`*^9, 3.90523994598303*^9},
 CellLabel->
  "During evaluation of \
In[3302]:=",ExpressionUUID->"005a60b1-cbb2-4fcd-a11f-8ff230edfb54"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "0", ",", "0", ",", 
   FractionBox[
    RowBox[{"3", " ", "\[ImaginaryI]", " ", "h"}], 
    RowBox[{"2", " ", 
     SqrtBox[
      RowBox[{"1", "-", 
       SuperscriptBox["\[Xi]", "2"]}]], " ", "\[Omega]"}]], ",", 
   FractionBox[
    RowBox[{"3", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", "h", " ", "\[Xi]"}], "-", 
       RowBox[{"2", " ", "h", " ", 
        SuperscriptBox["\[Xi]", "3"]}], "+", 
       RowBox[{"\[ImaginaryI]", " ", "h", " ", 
        SqrtBox[
         RowBox[{"1", "-", 
          SuperscriptBox["\[Xi]", "2"]}]]}], "-", 
       RowBox[{"2", " ", "\[ImaginaryI]", " ", "h", " ", 
        SuperscriptBox["\[Xi]", "2"], " ", 
        SqrtBox[
         RowBox[{"1", "-", 
          SuperscriptBox["\[Xi]", "2"]}]]}]}], ")"}]}], 
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       SuperscriptBox["\[Xi]", "2"]}], ")"}], " ", "\[Omega]"}]]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.90518384230949*^9, 3.905183868412505*^9}, 
   3.905183984897805*^9, {3.9051863757463455`*^9, 3.90518638912935*^9}, 
   3.9051877004899483`*^9, {3.9051878215653667`*^9, 3.905187836196182*^9}, 
   3.9051917071513376`*^9, 3.9051917806781416`*^9, 3.9051918285106964`*^9, {
   3.905192139171782*^9, 3.905192167613685*^9}, {3.9051922308591366`*^9, 
   3.905192242665907*^9}, {3.905192290185226*^9, 3.9051923608500986`*^9}, 
   3.9051925344602814`*^9, 3.905193152822033*^9, {3.9052380483114815`*^9, 
   3.9052380655522995`*^9}, 3.905238178056238*^9, 3.905239441217461*^9, 
   3.905239604567486*^9, {3.9052397665987825`*^9, 3.9052398210804973`*^9}, 
   3.9052398560525417`*^9, 3.9052399459869156`*^9},
 CellLabel->
  "Out[3379]=",ExpressionUUID->"382fba62-f464-4e28-8b77-6563deb4032d"],

Cell[BoxData["\<\"z_1*z_2^2 monomial\"\>"], "Print",
 CellChangeTimes->{
  3.9052396044404907`*^9, {3.9052397665347815`*^9, 3.9052398210164366`*^9}, 
   3.9052398559955416`*^9, 3.905239945988916*^9},
 CellLabel->
  "During evaluation of \
In[3302]:=",ExpressionUUID->"100510ad-31e1-4825-8565-504f6a1046c8"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "0", ",", "0", ",", 
   RowBox[{"-", 
    FractionBox[
     RowBox[{"3", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"\[ImaginaryI]", " ", "h", " ", "\[Xi]"}], "+", 
        RowBox[{"h", " ", 
         SqrtBox[
          RowBox[{"1", "-", 
           SuperscriptBox["\[Xi]", "2"]}]]}]}], ")"}]}], 
     RowBox[{"2", " ", 
      RowBox[{"(", 
       RowBox[{"\[ImaginaryI]", "-", 
        RowBox[{"\[ImaginaryI]", " ", 
         SuperscriptBox["\[Xi]", "2"]}], "+", 
        RowBox[{"\[Xi]", " ", 
         SqrtBox[
          RowBox[{"1", "-", 
           SuperscriptBox["\[Xi]", "2"]}]]}]}], ")"}], " ", "\[Omega]"}]]}], 
   ",", 
   RowBox[{"-", 
    FractionBox[
     RowBox[{"3", " ", "\[ImaginaryI]", " ", "h"}], 
     RowBox[{"2", " ", 
      SqrtBox[
       RowBox[{"1", "-", 
        SuperscriptBox["\[Xi]", "2"]}]], " ", "\[Omega]"}]]}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.90518384230949*^9, 3.905183868412505*^9}, 
   3.905183984897805*^9, {3.9051863757463455`*^9, 3.90518638912935*^9}, 
   3.9051877004899483`*^9, {3.9051878215653667`*^9, 3.905187836196182*^9}, 
   3.9051917071513376`*^9, 3.9051917806781416`*^9, 3.9051918285106964`*^9, {
   3.905192139171782*^9, 3.905192167613685*^9}, {3.9051922308591366`*^9, 
   3.905192242665907*^9}, {3.905192290185226*^9, 3.9051923608500986`*^9}, 
   3.9051925344602814`*^9, 3.905193152822033*^9, {3.9052380483114815`*^9, 
   3.9052380655522995`*^9}, 3.905238178056238*^9, 3.905239441217461*^9, 
   3.905239604567486*^9, {3.9052397665987825`*^9, 3.9052398210804973`*^9}, 
   3.9052398560525417`*^9, 3.905239945990915*^9},
 CellLabel->
  "Out[3383]=",ExpressionUUID->"a1b6dd5d-2b27-4227-805c-896005cd0ab7"],

Cell[BoxData["\<\"z_2^3 monomial\"\>"], "Print",
 CellChangeTimes->{
  3.9052396044404907`*^9, {3.9052397665347815`*^9, 3.9052398210164366`*^9}, 
   3.9052398559955416`*^9, 3.905239945992917*^9},
 CellLabel->
  "During evaluation of \
In[3302]:=",ExpressionUUID->"35f3575c-3dc2-435c-86c7-c8a42cb73db1"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox[
    RowBox[{
     RowBox[{
      RowBox[{"-", "3"}], " ", "h", " ", "\[Xi]"}], "+", 
     RowBox[{"4", " ", "h", " ", 
      SuperscriptBox["\[Xi]", "3"]}], "+", 
     RowBox[{"\[ImaginaryI]", " ", "h", " ", 
      SqrtBox[
       RowBox[{"1", "-", 
        SuperscriptBox["\[Xi]", "2"]}]]}], "-", 
     RowBox[{"4", " ", "\[ImaginaryI]", " ", "h", " ", 
      SuperscriptBox["\[Xi]", "2"], " ", 
      SqrtBox[
       RowBox[{"1", "-", 
        SuperscriptBox["\[Xi]", "2"]}]]}]}], 
    RowBox[{"4", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", "\[ImaginaryI]"}], "-", 
       RowBox[{"3", " ", "\[ImaginaryI]", " ", 
        SuperscriptBox["\[Xi]", "2"]}], "+", 
       RowBox[{"3", " ", "\[Xi]", " ", 
        SqrtBox[
         RowBox[{"1", "-", 
          SuperscriptBox["\[Xi]", "2"]}]]}]}], ")"}], " ", 
     SuperscriptBox["\[Omega]", "2"]}]], ",", 
   FractionBox[
    RowBox[{"3", " ", 
     RowBox[{"(", 
      RowBox[{"h", "-", 
       RowBox[{"2", " ", "h", " ", 
        SuperscriptBox["\[Xi]", "2"]}], "+", 
       RowBox[{"2", " ", "\[ImaginaryI]", " ", "h", " ", "\[Xi]", " ", 
        SqrtBox[
         RowBox[{"1", "-", 
          SuperscriptBox["\[Xi]", "2"]}]]}]}], ")"}]}], 
    RowBox[{"4", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", "\[ImaginaryI]"}], "-", 
       RowBox[{"3", " ", "\[ImaginaryI]", " ", 
        SuperscriptBox["\[Xi]", "2"]}], "+", 
       RowBox[{"3", " ", "\[Xi]", " ", 
        SqrtBox[
         RowBox[{"1", "-", 
          SuperscriptBox["\[Xi]", "2"]}]]}]}], ")"}], " ", "\[Omega]"}]], ",",
    "0", ",", "0", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{{3.90518384230949*^9, 3.905183868412505*^9}, 
   3.905183984897805*^9, {3.9051863757463455`*^9, 3.90518638912935*^9}, 
   3.9051877004899483`*^9, {3.9051878215653667`*^9, 3.905187836196182*^9}, 
   3.9051917071513376`*^9, 3.9051917806781416`*^9, 3.9051918285106964`*^9, {
   3.905192139171782*^9, 3.905192167613685*^9}, {3.9051922308591366`*^9, 
   3.905192242665907*^9}, {3.905192290185226*^9, 3.9051923608500986`*^9}, 
   3.9051925344602814`*^9, 3.905193152822033*^9, {3.9052380483114815`*^9, 
   3.9052380655522995`*^9}, 3.905238178056238*^9, 3.905239441217461*^9, 
   3.905239604567486*^9, {3.9052397665987825`*^9, 3.9052398210804973`*^9}, 
   3.9052398560525417`*^9, 3.9052399459959974`*^9},
 CellLabel->
  "Out[3387]=",ExpressionUUID->"deb30fa7-3854-461d-8352-3f4ba1774162"]
}, Open  ]]
},
WindowSize->{960, 532},
WindowMargins->{{-5.5, Automatic}, {Automatic, -5.5}},
FrontEndVersion->"13.0 for Microsoft Windows (64-bit) (February 4, 2022)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"482bda55-0541-4721-9d40-61458bb5ac2a"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 27122, 770, 2312, "Input",ExpressionUUID->"74947bcf-1700-47d9-884d-34c3cd0b9770"],
Cell[CellGroupData[{
Cell[27727, 796, 295, 6, 22, "Print",ExpressionUUID->"51464f45-70a8-4027-a4c5-0bc0982467d1"],
Cell[28025, 804, 1564, 41, 52, "Print",ExpressionUUID->"feebc075-17bf-4933-bce6-e4bb8dd0cfc3"],
Cell[29592, 847, 1349, 36, 38, "Print",ExpressionUUID->"2060cfc5-4a37-4815-852b-49dc909f10f9"],
Cell[30944, 885, 1062, 28, 52, "Print",ExpressionUUID->"b106c9e5-b38c-4de2-adb7-22945bc2c6fb"],
Cell[32009, 915, 1840, 49, 56, "Print",ExpressionUUID->"9e68e59e-462d-4c2b-b024-8224762e120d"],
Cell[33852, 966, 307, 6, 22, "Print",ExpressionUUID->"40ca4219-e388-4be4-8234-d03611040671"],
Cell[34162, 974, 4672, 117, 62, "Print",ExpressionUUID->"64eda1a4-6a9a-4ac6-bf68-ccd4d069d10e"],
Cell[38837, 1093, 292, 6, 22, "Print",ExpressionUUID->"2ab9539c-d451-4ebf-a187-8f454bc37309"],
Cell[39132, 1101, 306, 6, 22, "Print",ExpressionUUID->"17a8f4d2-7768-4c9f-a12d-2fa44ff739f7"],
Cell[39441, 1109, 951, 25, 22, "Print",ExpressionUUID->"a5b6ded4-3c66-4c4b-ab62-867e64ab6939"],
Cell[40395, 1136, 644, 15, 22, "Print",ExpressionUUID->"a73b6435-0249-4e90-b34f-265fed334404"],
Cell[41042, 1153, 400, 10, 22, "Print",ExpressionUUID->"97e5b519-34f2-44bb-b9f7-b92a67e2fdd7"],
Cell[41445, 1165, 306, 6, 22, "Print",ExpressionUUID->"bcd5c9ed-3f06-46e7-9bff-cec655f19302"],
Cell[41754, 1173, 665, 18, 22, "Print",ExpressionUUID->"9ded82ce-41d0-47b3-84c3-d2d31ef88aa5"],
Cell[42422, 1193, 686, 19, 22, "Print",ExpressionUUID->"22a0aff2-0b5a-4113-95f3-f4710b0196cf"],
Cell[43111, 1214, 295, 6, 22, "Print",ExpressionUUID->"f622ff60-b057-4d6d-be74-8b9cc81a34a3"],
Cell[43409, 1222, 2885, 71, 61, "Print",ExpressionUUID->"74f0bc0e-74cb-4737-8579-9ecbc1349718"],
Cell[46297, 1295, 2292, 60, 42, "Print",ExpressionUUID->"a548e540-bc22-4f9a-ab51-8be7e90fb8f9"],
Cell[48592, 1357, 2796, 70, 52, "Print",ExpressionUUID->"6d8d8a47-4445-4745-a432-fb954a4da721"],
Cell[51391, 1429, 3594, 89, 62, "Print",ExpressionUUID->"4e4e2b7d-28e8-4e21-aa17-0ae5dfd51dd7"],
Cell[54988, 1520, 305, 6, 22, "Print",ExpressionUUID->"4c496ea6-76d1-4812-aa7d-c83198aa265a"],
Cell[55296, 1528, 7292, 183, 127, "Print",ExpressionUUID->"0289f70c-2edc-4af6-a1a1-b6ecac301063"],
Cell[62591, 1713, 1400, 36, 23, "Print",ExpressionUUID->"97aa5d68-67cd-4f88-9f94-338bfafd3c47"],
Cell[63994, 1751, 325, 6, 22, "Print",ExpressionUUID->"fa613454-4cb5-4f4c-b1a4-90c5c08a8257"],
Cell[64322, 1759, 311, 6, 22, "Print",ExpressionUUID->"073246c7-ed14-411a-a978-2da8264620a1"],
Cell[64636, 1767, 305, 6, 22, "Print",ExpressionUUID->"b91329b3-2d0d-4d24-867e-18127a30d822"],
Cell[64944, 1775, 1565, 49, 52, "Print",ExpressionUUID->"53333c94-30ff-4ff8-a395-c0761635d04c"],
Cell[66512, 1826, 292, 6, 22, "Print",ExpressionUUID->"d493b289-d19b-4c49-be86-14dba7bb5055"],
Cell[66807, 1834, 320, 6, 22, "Print",ExpressionUUID->"8775e021-dc6e-437b-a76d-5f0b270eb95a"],
Cell[67130, 1842, 304, 6, 22, "Print",ExpressionUUID->"b0a99f22-e1df-41d2-8c9d-6ac67bcce512"]
}, Open  ]],
Cell[67449, 1851, 2533, 63, 70, "Output",ExpressionUUID->"4d9d0c51-dd07-4e3b-9f39-8da12935a62c"],
Cell[69985, 1916, 305, 6, 22, "Print",ExpressionUUID->"005a60b1-cbb2-4fcd-a11f-8ff230edfb54"],
Cell[70293, 1924, 1799, 42, 64, "Output",ExpressionUUID->"382fba62-f464-4e28-8b77-6563deb4032d"],
Cell[72095, 1968, 306, 6, 22, "Print",ExpressionUUID->"100510ad-31e1-4825-8565-504f6a1046c8"],
Cell[72404, 1976, 1729, 42, 70, "Output",ExpressionUUID->"a1b6dd5d-2b27-4227-805c-896005cd0ab7"],
Cell[74136, 2020, 302, 6, 22, "Print",ExpressionUUID->"35f3575c-3dc2-435c-86c7-c8a42cb73db1"],
Cell[74441, 2028, 2485, 61, 70, "Output",ExpressionUUID->"deb30fa7-3854-461d-8352-3f4ba1774162"]
}, Open  ]]
}
]
*)

